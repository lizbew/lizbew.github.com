---
layout: post
title: "花生壳访问内网机器"
description: ""
category: web
tags: [oray]
---
{% include JB/setup %}

原始发布于： http://blog.viifly.com/blog/posts/5857545117761536

花生壳的动态DNS确实是个有用的工具，有了它，个人建站就更容易了。现在很多家用路由器都内嵌花生壳了，免去了安装客户端的麻烦，使用也更简单了。

折腾了两个晚上，终于搞定了。

花生壳的主要功能就是将ADSL获得的外网动态IP定期发送花生壳的服务器端，以更新DNS记录。这里的外网动态IP, 是从ADSL访问外部网站时，外部网站看到的客户端IP。花生壳的[协议][1]已经公开了，且有Linux下开源下载。想要自己实现个花生壳也是可能的，不过没多大必要。

主要步骤：

* 注册花生壳账号，获得一个免费子域名
* 在路由器中开启花生壳功能，输入账号、密码后建立连接
* 在路由器添加一个虚拟主机，实际就是添加端口到IP的映射。比如以花生壳免费子域名访问80端口时，将会访问重定向到内网IP指定的机器。通常80端口会被ISP禁用，所以建立website时需换用其它端口。
* 用浏览器打开http://ddns.oray.com/checkip，可以看到ADSL获得的动态IP。需要将这个IP里与路由器里WAN口IP比较下，通常是一样的。如果不一样，刚ISP分布IP里使用的NAT。如是是NAT，就不知道花生壳是如何解决这个问题的。


  [1]: http://open.oray.com/wiki/doku.php

